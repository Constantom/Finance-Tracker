<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Expenses | Finance Tracker</title>
<link rel="stylesheet" href="assets/css/variables.css">
<link rel="stylesheet" href="assets/css/base.css">
<link rel="stylesheet" href="assets/css/layout.css">
<link rel="stylesheet" href="assets/css/components.css">
<link rel="stylesheet" href="assets/css/pages.css">
<style>
.card{padding:25px;border-radius:12px;margin-bottom:30px;}
.table th,.table td{padding:12px 15px;}
.table tbody tr:not(:last-child){border-bottom:1px solid #eee;}
.theme-btn{position:absolute;top:20px;right:20px;padding:6px 12px;border:none;border-radius:6px;cursor:pointer;background:var(--color-accent);color:#fff;}
.form-group{display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;}
.form-group input,.form-group select{flex:1;padding:10px;border-radius:6px;border:1px solid #ccc;}
.form-group button{padding:10px 20px;border:none;border-radius:6px;background:var(--color-danger);color:#fff;cursor:pointer;}
</style>
</head>
<body>

<button id="themeToggle" class="theme-btn">Toggle Dark / Light</button>

<div class="app">
  <aside class="sidebar">
    <h2>Finance Tracker</h2>
    <nav class="nav">
      <a href="index.html">Dashboard</a>
      <a href="income.html">Income</a>
      <a href="expenses.html" class="active">Expenses</a>
      <a href="categories.html">Categories</a>
      <a href="reports.html">Reports</a>
      <a href="settings.html">Settings</a>
    </nav>
  </aside>

  <main class="main">
    <header class="header"><h1>Expenses</h1></header>

    <section class="card">
      <form id="expenseForm" class="form-group">
        <input type="date" id="expenseDate" required>
        <input type="text" id="expenseDescription" placeholder="Description" required>
        <select id="expenseCategory" required>
          <option value="Food">Food</option>
          <option value="Rent">Rent</option>
          <option value="Bills">Bills</option>
          <option value="Other">Other</option>
        </select>
        <input type="number" id="expenseAmount" placeholder="Amount" required>
        <button type="submit">Add Expense</button>
      </form>

      <table class="table">
        <thead>
          <tr><th>Date</th><th>Description</th><th>Category</th><th>Amount</th></tr>
        </thead>
        <tbody id="expenseTable"></tbody>
      </table>
    </section>
  </main>
</div>

<script src="assets/js/theme.js"></script>
<script>
const currentUser = JSON.parse(localStorage.getItem('currentUser'));
if(!currentUser) window.location.href='login.html';

const expenseForm = document.getElementById('expenseForm');
const expenseTable = document.getElementById('expenseTable');


function renderExpenses(){
  const allExpenses = JSON.parse(localStorage.getItem('expenses')) || [];
  const expenses = allExpenses.filter(t => t.userEmail === currentUser.email);
  expenseTable.innerHTML = '';
  expenses.forEach(t => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${t.date}</td>
      <td>${t.description}</td>
      <td>${t.category}</td>
      <td style="color:var(--color-danger)">- â‚¦${parseFloat(t.amount).toLocaleString()}</td>
    `;
    expenseTable.appendChild(row);
  });
}

expenseForm.onsubmit = e => {
  e.preventDefault();
  const date = document.getElementById('expenseDate').value;
  const desc = document.getElementById('expenseDescription').value.trim();
  const category = document.getElementById('expenseCategory').value;
  const amount = document.getElementById('expenseAmount').value;

  const allExpenses = JSON.parse(localStorage.getItem('expenses')) || [];
  allExpenses.push({date, description: desc, category, amount, userEmail: currentUser.email});
  localStorage.setItem('expenses', JSON.stringify(allExpenses));

  expenseForm.reset();
  renderExpenses();
}

renderExpenses();
</script>
</body>
</html>
