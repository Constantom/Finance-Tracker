<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Categories | Finance Tracker</title>
<link rel="stylesheet" href="assets/css/variables.css">
<link rel="stylesheet" href="assets/css/base.css">
<link rel="stylesheet" href="assets/css/layout.css">
<link rel="stylesheet" href="assets/css/components.css">
<link rel="stylesheet" href="assets/css/pages.css">
<style>
  .card{padding:25px;border-radius:12px;margin-bottom:30px;}
  .table th,.table td{padding:12px 15px;}
  .table tbody tr:not(:last-child){border-bottom:1px solid #eee;}
  .theme-btn{position:absolute;top:20px;right:20px;padding:6px 12px;border:none;border-radius:6px;cursor:pointer;background:var(--color-accent);color:#fff;}
  .form-group{display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;}
  .form-group input{flex:1;padding:10px;border-radius:6px;border:1px solid #ccc;}
  .form-group button{padding:10px 20px;border:none;border-radius:6px;background:var(--color-accent);color:#fff;cursor:pointer;}
  .delete-btn{padding:6px 12px;border:none;border-radius:6px;background:var(--color-danger);color:#fff;cursor:pointer;}
</style>
</head>
<body>

<button id="themeToggle" class="theme-btn">Toggle Dark / Light</button>

<div class="app">
  <aside class="sidebar">
    <h2>Finance Tracker</h2>
    <nav class="nav">
      <a href="index.html">Dashboard</a>
      <a href="income.html">Income</a>
      <a href="expenses.html">Expenses</a>
      <a href="categories.html" class="active">Categories</a>
      <a href="reports.html">Reports</a>
      <a href="settings.html">Settings</a>
    </nav>
  </aside>

  <main class="main">
    <header class="header"><h1>Categories</h1></header>

    <section class="card">
      <form id="categoryForm" class="form-group">
        <input type="text" id="categoryName" placeholder="New Category Name" required>
        <button type="submit">Add Category</button>
      </form>

      <table class="table">
        <thead><tr><th>Category</th><th>Action</th></tr></thead>
        <tbody id="categoryTable"></tbody>
      </table>
    </section>
  </main>
</div>

<script src="assets/js/theme.js"></script>
<script>
const currentUser = JSON.parse(localStorage.getItem('currentUser'));
if(!currentUser) window.location.href='login.html';

const categoryForm = document.getElementById('categoryForm');
const categoryTable = document.getElementById('categoryTable');

function renderCategories(){
  const categories = JSON.parse(localStorage.getItem('categories')) || [];
  categoryTable.innerHTML='';
  categories.forEach((c,i)=>{
    const row = document.createElement('tr');
    row.innerHTML = `<td>${c.name}</td><td><button class="delete-btn" data-index="${i}">Delete</button></td>`;
    categoryTable.appendChild(row);
  });


  window.dispatchEvent(new Event('storage'));
}

categoryForm.onsubmit = e => {
  e.preventDefault();
  const name = document.getElementById('categoryName').value.trim();
  if(!name) return;

  const categories = JSON.parse(localStorage.getItem('categories')) || [];
  if(categories.find(c=>c.name.toLowerCase()===name.toLowerCase())) {
    alert('Category already exists!');
    return;
  }
  categories.push({name});
  localStorage.setItem('categories',JSON.stringify(categories));
  categoryForm.reset();
  renderCategories();
}

categoryTable.addEventListener('click', e => {
  if(!e.target.classList.contains('delete-btn')) return;
  const idx = e.target.getAttribute('data-index');
  const categories = JSON.parse(localStorage.getItem('categories')) || [];
  categories.splice(idx,1);
  localStorage.setItem('categories',JSON.stringify(categories));
  renderCategories();
});

renderCategories();
</script>
</body>
</html>
